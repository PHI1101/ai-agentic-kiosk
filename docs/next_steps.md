# 다음 단계 (Next Steps)

이 문서는 현재 진행 중인 AI 키오스크 프로젝트의 다음 주요 개선 사항을 요약합니다.

## 1. 개선된 메뉴 추천 흐름 구현

현재 AI 키오스크는 사용자가 특정 음식 종류를 요청하면 해당 음식 종류에 해당하는 모든 메뉴를 나열합니다. 사용자 피드백에 따라, 대화 흐름을 더욱 자연스럽고 직관적으로 개선하기 위해 다음과 같은 메뉴 추천 흐름을 구현해야 합니다.

### 1.1. 목표

*   사용자가 특정 음식 종류(예: "버거", "커피")를 요청하면, 해당 음식 종류를 제공하는 **가게 목록**을 먼저 보여줍니다.
*   사용자가 가게를 선택하면, 해당 가게에서 제공하는 **메뉴 항목**을 보여줍니다.

### 1.2. 구현 상세

#### 1.2.1. `backend/orders/views.py` 수정

*   **`simple_nlu` 함수 개선:**
    *   **가게 목록 요청 의도 감지:** "가게 보여줘", "어떤 가게가 있어?", "[음식 종류] 파는 가게 알려줘" 등과 같은 사용자 발화에서 가게 목록을 요청하는 의도를 감지해야 합니다.
    *   **특정 가게 선택 의도 감지:** "롯데리아요", "맘스터치", "[가게 이름] 메뉴 보여줘" 등과 같은 사용자 발화에서 특정 가게를 선택하는 의도를 감지해야 합니다.

*   **`ChatWithAIView` 클래스 개선:**
    *   **대화 상태 관리:** `currentState` 객체를 확장하여 사용자가 현재 어떤 음식 종류를 찾고 있는지, 어떤 가게 목록이 제시되었는지, 어떤 가게가 선택되었는지 등의 대화 상태를 유지해야 합니다. 이는 다음 대화 턴에서 AI가 적절하게 응답하는 데 필수적입니다.
    *   **가게 목록 제시 로직:**
        *   사용자가 음식 종류를 요청하면, `MenuItem` 모델을 쿼리하여 해당 음식 종류를 제공하는 모든 `Store`를 찾고, 이들의 이름을 사용자에게 제시하는 응답을 생성합니다.
        *   예시 응답: "현재 버거를 판매하는 가게는 롯데리아와 맘스터치가 있습니다. 어느 가게 메뉴를 보시겠어요?"
    *   **선택된 가게 메뉴 목록 제시 로직:**
        *   사용자가 가게를 선택하면, 해당 `Store`의 `MenuItem`들을 쿼리하여 메뉴 이름과 가격을 사용자에게 제시하는 응답을 생성합니다.
        *   예시 응답: "롯데리아에는 불고기버거(4500원), 새우버거(4500원), 데리버거(3000원)가 있습니다."
    *   **응답 생성:** OpenAI API 호출 전에 `system_prompt`와 `db_search_result`를 동적으로 구성하여, AI가 개선된 흐름에 맞춰 자연스럽게 응답하도록 유도합니다.

---
